{
  "annotations": {
    "list": []
  },
  "description": "DORA metrics from Azure DevOps deployments - Simple working version",
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 1,
  "id": null,
  "links": [],
  "panels": [
    {
      "datasource": {
        "type": "prometheus",
        "uid": "openobserve-metrics"
      },
      "description": "Total deployments by status\n\nQuery: deploy_deployment_count\n\nThis metric shows the count of deployments grouped by service_name and deployment_status labels. The collector scrapes deployment data from Azure DevOps Release Management API and tracks each deployment's status (succeeded, failed, inProgress, etc.). Each time series represents a unique combination of service and status.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "spanNulls": true,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 0
      },
      "id": 1,
      "options": {
        "legend": {
          "calcs": ["last"],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        }
      },
      "pluginVersion": "10.0.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "openobserve-metrics"
          },
          "editorMode": "code",
          "expr": "deploy_deployment_count",
          "legendFormat": "{{service_name}} - {{deployment_status}}",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Deployment Count by Service & Status",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "openobserve-metrics"
      },
      "description": "Average deployment duration by service\n\nQuery: deploy_deployment_average_duration\n\nThis metric calculates the average time (in seconds) a deployment takes from start to completion for each service. The duration is computed from the startedOn and completedOn timestamps in the Azure DevOps deployment data. Lower values indicate faster deployments.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "spanNulls": true,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "s"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 0
      },
      "id": 2,
      "options": {
        "legend": {
          "calcs": ["last"],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        }
      },
      "pluginVersion": "10.0.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "openobserve-metrics"
          },
          "editorMode": "code",
          "expr": "deploy_deployment_average_duration",
          "legendFormat": "{{service_name}}",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Average Deployment Duration",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "openobserve-metrics"
      },
      "description": "Deployment Frequency (deployments per day)\n\nQuery: sum(deploy_deployment_count{deployment_status=\"succeeded\"})\n\nThis aggregates all successful deployments across all services. The query filters for only succeeded deployments and sums them to provide a total count. This is a key DORA metric indicating deployment frequency. Higher values suggest more frequent releases.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "red",
                "value": null
              },
              {
                "color": "yellow",
                "value": 1
              },
              {
                "color": "green",
                "value": 5
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 6,
        "x": 0,
        "y": 8
      },
      "id": 3,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": ["lastNotNull"],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "10.0.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "openobserve-metrics"
          },
          "editorMode": "code",
          "expr": "sum(deploy_deployment_count{deployment_status=\"succeeded\"})",
          "legendFormat": "Total Deployments",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Total Successful Deployments",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "openobserve-metrics"
      },
      "description": "Average deployment duration across all services\n\nQuery: avg(deploy_deployment_average_duration)\n\nThis calculates the mean deployment duration across all services by averaging the deploy_deployment_average_duration metric. The result shows overall deployment performance in seconds. This helps identify if deployment times are trending up or down across the organization.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "yellow",
                "value": 300
              },
              {
                "color": "red",
                "value": 600
              }
            ]
          },
          "unit": "s"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 6,
        "x": 12,
        "y": 8
      },
      "id": 5,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": ["mean"],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "10.0.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "openobserve-metrics"
          },
          "editorMode": "code",
          "expr": "avg(deploy_deployment_average_duration)",
          "legendFormat": "Avg Duration",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Avg Deployment Duration",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "openobserve-metrics"
      },
      "description": "Time of the most recent deployment\n\nQuery: max(deploy_deployment_last_timestamp) * 1000\n\nThis finds the most recent deployment timestamp across all services using the max() function on deploy_deployment_last_timestamp. The result is multiplied by 1000 to convert from seconds to milliseconds for Grafana's dateTimeFromNow formatter, which displays how long ago the last deployment occurred.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "dateTimeFromNow"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 6,
        "x": 0,
        "y": 17
      },
      "id": 7,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "values": false,
          "calcs": ["lastNotNull"],
          "fields": ""
        },
        "textMode": "auto"
      },
      "pluginVersion": "10.0.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "openobserve-metrics"
          },
          "editorMode": "code",
          "expr": "max(deploy_deployment_last_timestamp) * 1000",
          "legendFormat": "Last Deployment",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Last Deployment Time",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "openobserve-metrics"
      },
      "description": "Change Failure Rate (CFR) - Percentage of deployments that failed\n\nQuery: (sum(deploy_deployment_count{deployment_status=\"failed\"}) / sum(deploy_deployment_count)) * 100\n\nThis DORA metric calculates the percentage of deployments with status=failed. The scraper normalizes Azure DevOps statuses to OTel semantic conventions:\n\nCounted as FAILED: failed, partiallySucceeded, notDeployed (queued but never executed)\nCounted as SUCCEEDED: succeeded\nSkipped (non-final): inProgress, undefined\n\nLower is better. DORA benchmarks: Elite <15%, High 16-30%, Medium 31-45%, Low >45%.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "max": 100,
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "yellow",
                "value": 15
              },
              {
                "color": "orange",
                "value": 30
              },
              {
                "color": "red",
                "value": 45
              }
            ]
          },
          "unit": "percent"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 6,
        "x": 6,
        "y": 17
      },
      "id": 8,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "values": false,
          "calcs": ["lastNotNull"],
          "fields": ""
        },
        "textMode": "auto"
      },
      "pluginVersion": "10.0.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "openobserve-metrics"
          },
          "editorMode": "code",
          "expr": "(sum(deploy_deployment_count{deployment_status=\"failed\"}) / sum(deploy_deployment_count)) * 100",
          "legendFormat": "Change Failure Rate",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Change Failure Rate",
      "type": "stat"
    }
  ],
  "refresh": "30s",
  "schemaVersion": 38,
  "style": "dark",
  "tags": ["dora", "deployments", "azure-devops"],
  "templating": {
    "list": []
  },
  "time": {
    "from": "now-24h",
    "to": "now"
  },
  "timepicker": {},
  "timezone": "",
  "title": "ADO DORA Metrics (Simple)",
  "uid": "ado-dora-simple",
  "version": 1,
  "weekStart": ""
}
